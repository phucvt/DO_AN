<% provide(:title, @user.name) %>
<div class="container">
  <div class="row">
    <div class="col-md-2 post-id-image">
      <%= render 'shared/user_info' %>
    </div>
    <div class="col-md-9 description-para">
      <div class="profile-content">
        <div class="row">
          <div class="col-md-12">
            <div class="profile-userbuttons">
              <strong>Tin nhắn</strong>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-12">
            <div class="bs-callout bs-callout-info" id="callout-type-dl-truncate">
              <div class="row">
                <div class="col-md-6">
                  <h4>Người gửi: </h4>
                  <% if @message.sender_id == current_user.id %>
                  <%= link_to "Tôi", current_user %>
                  <% else %>
                  <%= User.find(@message.sender_id)[:name] %>
                  <% end %>
                </div>
                <div class="col-md-6">
                  <h4>Người nhận: </h4>
                  <% if @message.receiver_id == current_user.id %>
                  <%= link_to "Tôi", current_user %>
                  <% else %>
                  <%= link_to @message.receiver[:name], @message.receiver %>
                  <% end %>
                </div>
              </div>
              <div class="row">
                <div class="col-md-12">
                  <h4>Gửi: </h4>
                  <%= time_ago_in_words(@message.created_at) %> trước.
                </div>
              </div>
              <div class="row">
                <div class="col-md-12">
                  <h4>Nội dung:</h4>
                  <p><%= @message.content %></p>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row text-center">
          <%= link_to 'Xóa', user_message_path(current_user, @message), class: "btn btn-danger",
            method: :delete,
            data: { confirm: 'Are you sure?' } %>
        </div>
        <div class="profile-userbuttons">
          <button type="button" data-toggle="modal" data-target="#squarespaceModal" class="btn btn-danger btn-sm">Trả lời</button>
        </div>
        <div class="modal fade" id="squarespaceModal" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
                <h3 class="modal-title text-center" id="lineModalLabel">Send private message</h3>
                <% if @all_error_messages != nil %>
                <div class="errors-form">
                  <div class="form-group">
                    <div class="row">
                      <div class="col-md-12 col-lg-12">
                        <%= render 'shared/error_created_message' %>
                      </div>
                    </div>
                  </div>
                </div>
                <% end %>
              </div>
              <% if logged_in?   %>
              <%= form_for Message.new, url: user_messages_path(@user), method: :post do |m| %>
              <%=  m.hidden_field :sender_id, :value => current_user.id %>
              <%=  m.hidden_field :receiver_id, :value => @message.sender_id %>
              <div class="modal-body">
                <!-- content goes here -->
                <div class="form-group">
                  <%= m.label :title, class: "control-label" %>
                  <%= m.text_field :title, class: "form-control", placeholder: "Title" %>
                </div>
                <div class="form-group">
                  <%= m.label :content, class: "control-label" %>
                  <%= m.text_area :content, class: "form-control", placeholder: "Content" %>
                </div>
              </div>
              <div class="modal-footer">
                <div class="btn-group btn-group-justified" role="group" aria-label="group button">
                  <div class="btn-group" role="group">
                    <button type="button" class="btn btn-default" data-dismiss="modal"  role="button">Close</button>
                  </div>
                  <div class="btn-group btn-delete hidden" role="group">
                    <button type="button" id="delImage" class="btn btn-default btn-hover-red" data-dismiss="modal"  role="button">Delete</button>
                  </div>
                  <div class="btn-group" role="group">
                    <%= m.submit "Send", class: "btn btn-default btn-hover-green" %>
                  </div>
                </div>
              </div>
              <% end %>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>